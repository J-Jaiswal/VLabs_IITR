<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Virtual Labs</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
      name="viewport"
    />
    <!-- Bootstrap 3.3.6 -->
    <link rel="stylesheet" href="../../bootstrap/css/bootstrap.css" />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css"
    />
    <!-- Theme style -->
    <link rel="stylesheet" href="../../dist/css/AdminLTE.css" />
    <!-- AdminLTE Skins. Choose a skin from the css/skins folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="../../dist/css/skins/_all-skins.min.css" />
    <script>
      window.onload = function () {
        document.getElementById("theory").className = "active treeview";
      };
    </script>
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        margin: 24px;
        color: #1f2937;
        background: #fff;
      }
      p,
      li {
        text-align: justify;
      }
      h1,
      h2,
      h3 {
        margin: 10px 0 6px;
        color: #111827;
      }
      .card {
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 14px 16px;
        margin: 12px 0;
        background: #fafafa;
      }
      .eq {
        background: #f8fafc;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 8px 10px;
        overflow: auto;
        margin: 8px 0;
      }
      code {
        background: #eef2f7;
        padding: 2px 6px;
        border-radius: 6px;
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas,
          "Liberation Mono", monospace;
      }
      .muted {
        color: #6b7280;
      }
      .hi {
        color: #0ea5e9;
        font-weight: 600;
      } /* accent highlight */
      .warn {
        color: #a855f7;
        font-weight: 600;
      } /* uncertainty highlight */
      ul,
      ol {
        margin-left: 18px;
      }
    </style>
  </head>

  <body class="hold-transition skin-blue sidebar-mini">
    <!--Navigation Bar-->
    <div class="navbar navbar-default">
      <div class="container">
        <div class="navbar-header">
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target="#navbar-ex-collapse"
          >
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://iitb.ac.in"
            ><span
              ><img
                src="images/iitrLogo.png"
                style="margin-top: -15px; height: 50px; width: 400px" /></span
          ></a>
        </div>
        <div class="collapse navbar-collapse" id="navbar-ex-collapse"></div>
      </div>
    </div>

    <div class="wrapper">
      <header class="main-header">
        <!-- Logo -->
        <a
          href="../index.html"
          class="logo"
          style="
            background-color: #009dff;
            border-right: solid;
            border-right-color: #1261a0;
          "
        >
          <p align="center" style="font-size: 1em"><b>Geophysics Lab</b></p>
        </a>
        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top" style="background-color: #009dff">
          <!-- Sidebar toggle button-->
          <a
            href="#"
            class="sidebar-toggle"
            data-toggle="offcanvas"
            role="button"
            id="toggle_nav"
          >
            <span class="sr-only">Toggle navigation</span>
          </a>
          <section class="content-header">
            <ol class="breadcrumb">
              <li>
                <a href="../index.html"
                  ><i class="fa fa-dashboard"></i>Geophysics Lab</a
                >
              </li>
              <li>
                <a href="#">Finding location of an earthquake</a>
              </li>
            </ol>
          </section>
        </nav>
      </header>

      <!-- Left side column. contains the logo and sidebar -->
      <aside class="main-sidebar" style="background-color: #1261a0">
        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">
          <!-- search form -->
          <form action="#" method="get" class="sidebar-form">
            <div class="input-group"></div>
          </form>
          <!-- /.sear ch form -->
          <!-- sidebar menu: : style can be found in sidebar.less -->
          <ul class="sidebar-menu" style="background-color: #1261a0">
            <li class="treeview" id="aim">
              <a href="index.html" id="aim">
                <i class="fa fa-files-o" style="color: white"></i>
                <span style="color: white">Aim</span>
              </a>
            </li>
            <li class="treeview" id="theory">
              <a href="theory.html" id="theory" onclick="theory()">
                <i class="fa fa-files-o" style="color: white"></i>
                <span style="color: white">Theory</span>
              </a>
            </li>
            <!--   <li class="treeview" id="numerical">
                    <a href="numerical.php">
                        <i class="fa fa-laptop"></i>
                        <span>Numerical</span>
                        <span class="pull-right-container">
                        </span>
                    </a>
                </li>
                <li class="treeview" id="program">
                    <a href="program.php">
                        <i class="fa fa-laptop"></i>
                        <span>Program</span>
                        <span class="pull-right-container">
                        </span>
                    </a>
                </li> -->
            <li class="treeview" id="pretest">
              <a href="pretest.html" id="pretest">
                <i class="fa fa-files-o" style="color: white"></i>
                <span style="color: white">Pre Test</span>
              </a>
            </li>

            <li class="treeview" id="procedure">
              <a href="procedure.html" id="procedure">
                <i class="fa fa-files-o" style="color: white"></i>
                <span style="color: white">Procedure</span>
              </a>
            </li>
            <li class="treeview" id="simulation">
              <a href="simulation.html" id="simulation">
                <i class="fa fa-laptop" style="color: white"></i>
                <span style="color: white">Simulation</span>
                <span class="pull-right-container"> </span>
              </a>
            </li>

            <li class="treeview" id="posttest">
              <a href=" posttest.html" id="posttest">
                <i class="fa fa-files-o" style="color: white"> </i>
                <span style="color: white">Post Test</span>
                <span class="pull-right-container"> </span>
              </a>
            </li>
            <li class="treeview" id="ref">
              <a href="references.html" id="references">
                <i class="fa fa-files-o" style="color: white"></i>
                <span style="color: white">References</span>
                <span class="pull-right-container"> </span>
              </a>
            </li>
          </ul>
        </section>
        <!-- /.sidebar -->
      </aside>

      <div class="content-wrapper">
        <section class="content-header">
          <h1 align="center">Finding location of an earthquake</h1>
        </section>

        <!-- Main content -->
        <section class="content">
          <div class="card">
            <h2>What this models</h2>
            <p>
              We simulate first-arrival (P-wave) picks from an earthquake with
              model
              <em>m</em> = [<em>x</em><sub>s</sub>, <em>y</em><sub>s</sub>,
              <em>t</em><sub>0</sub>, <em>v</em>], recorded at stations (<em
                >x</em
              ><sub>i</sub>, <em>y</em><sub>i</sub>, <em>z</em><sub>i</sub>).
              Depth is held fixed at <em>z</em> = 0 for inversion. Picks include
              Gaussian noise with standard deviation σ and (optionally) one
              outlier (±<em>k</em>σ, with <em>k</em> ∈ {3, 6}).
            </p>
            <ul>
              <li>
                Source–receiver distance:
                <span class="eq">
                  <span class="math">
                    <em>R</em><sub>i</sub> = √[ (<em>x</em><sub>s</sub> −
                    <em>x</em><sub>i</sub>)² + (<em>y</em><sub>s</sub> −
                    <em>y</em><sub>i</sub>)² + (0 − <em>z</em><sub>i</sub>)² ].
                  </span>
                </span>
              </li>
              <li>
                Residual at station <em>i</em>:
                <span class="eq">
                  <span class="math">
                    <em>r</em><sub>i</sub> = <em>t</em><sub>i</sub
                    ><sup>obs</sup> − <em>g</em><sub>i</sub>(<em>m</em>).
                  </span>
                </span>
              </li>
              <li class="muted">
                Units: km (distance), s (time), km·s<sup>−1</sup> (velocity)
              </li>
            </ul>
          </div>

          <div class="card">
            <h2>Forward model</h2>
            <div class="eq">
              <span class="math">
                <em>g</em><sub>i</sub>(<em>m</em>) = <em>t</em><sub>0</sub> +
                <em>R</em><sub>i</sub> / <em>v</em>, &nbsp;&nbsp; <em>R</em
                ><sub>i</sub> = √[ (<em>x</em><sub>s</sub> − <em>x</em
                ><sub>i</sub>)² + (<em>y</em><sub>s</sub> − <em>y</em
                ><sub>i</sub>)² + (0 − <em>z</em><sub>i</sub>)² ].
              </span>
            </div>
            <p>
              Synthetic observations (Gaussian noise and optional single
              outlier):
            </p>
            <div class="eq">
              <span class="math">
                <em>t</em><sub>i</sub><sup>obs</sup> = <em>t</em><sub>0</sub
                ><sup>true</sup> + <em>R</em><sub>i</sub>(<em>m</em
                ><sup>true</sup>) / <em>v</em><sup>true</sup> + ε<sub>i</sub> +
                δ<sub>i</sub><sup>outlier</sup>, &nbsp;&nbsp; ε<sub>i</sub> ∼
                𝒩(0, σ²), &nbsp;&nbsp; δ<sub>i</sub><sup>outlier</sup> ∈ {0,
                ±<em>k</em>σ} for one station.
              </span>
            </div>
          </div>

          <div class="card">
            <h2>
              Misfit map (epicentral scan with fixed
              <span class="hi"><em>v</em><sub>start</sub></span
              >)
            </h2>
            <p>
              For each grid point (<em>x</em>, <em>y</em>) with depth fixed at
              0, eliminate the origin time analytically:
            </p>
            <div class="eq">
              <span class="math">
                <em>t</em><sub>0</sub><sup>*</sup>(<em>x</em>,<em>y</em>) =
                (1/<em>N</em>) &nbsp;∑<sub>i=1</sub><sup>N</sup> [ <em>t</em
                ><sub>i</sub><sup>obs</sup> − <em>R</em
                ><sub>i</sub>(<em>x</em>,<em>y</em>,0)/<em>v</em
                ><sub>start</sub> ].
              </span>
            </div>
            <p>The displayed scalar field is the mean squared misfit:</p>
            <div class="eq">
              <span class="math">
                <em>J</em>(<em>x</em>,<em>y</em>) = (1/<em>N</em>) &nbsp;∑<sub
                  >i=1</sub
                ><sup>N</sup> [ <em>t</em><sub>i</sub><sup>obs</sup> − (
                <em>t</em><sub>0</sub><sup>*</sup>(<em>x</em>,<em>y</em>) +
                <em>R</em><sub>i</sub>(<em>x</em>,<em>y</em>,0)/<em>v</em
                ><sub>start</sub> ) ]².
              </span>
            </div>
            <p class="muted">
              Brighter basin ⇒ lower misfit under the assumed velocity. If
              <em>v</em><sub>start</sub> ≠ <em>v</em><sup>true</sup>, the basin
              may shift or skew.
            </p>
          </div>

          <div class="card">
            <h2>Inverse problem (Gauss–Newton with Tikhonov; no SVD)</h2>
            <p>
              At iteration <em>k</em>, with current estimate <em>m</em
              ><sup>(k)</sup>, define Δ<em>d</em> = <em>d</em><sup>obs</sup> −
              <em>g</em>(<em>m</em><sup>(k)</sup>) and the Jacobian <em>G</em> =
              ∂<em>g</em>/∂<em>m</em> evaluated at <em>m</em><sup>(k)</sup>.
              Using a constant weight <em>W</em> = σ<sup>−1</sup><em>I</em>, the
              damped least-squares subproblem is
            </p>
            <div class="eq">
              <span class="math">
                Φ(Δ<em>m</em>) = ‖ <em>W</em> ( Δ<em>d</em> − <em>G</em> Δ<em
                  >m</em
                >
                ) ‖<sub>2</sub>² + λ² ‖ Δ<em>m</em> ‖<sub>2</sub>².
              </span>
            </div>
            <p>The corresponding normal equations (solved directly) are</p>
            <div class="eq">
              <span class="math">
                ( <em>G</em><sup>⊤</sup> <em>W</em><sup>⊤</sup> <em>W</em>
                <em>G</em> + λ² <em>I</em> ) Δ<em>m</em> = <em>G</em
                ><sup>⊤</sup> <em>W</em><sup>⊤</sup> <em>W</em> Δ<em>d</em>.
              </span>
            </div>
            <p>
              With <em>z</em> fixed, the Jacobian row for station <em>i</em> is
            </p>
            <div class="eq">
              <span class="math">
                ∂<em>t</em><sub>i</sub>/∂<em>x</em><sub>s</sub> = (<em>x</em
                ><sub>s</sub> − <em>x</em><sub>i</sub>)/(<em>v</em> <em>R</em
                ><sub>i</sub>), &nbsp; ∂<em>t</em><sub>i</sub>/∂<em>y</em
                ><sub>s</sub> = (<em>y</em><sub>s</sub> − <em>y</em
                ><sub>i</sub>)/(<em>v</em> <em>R</em><sub>i</sub>), &nbsp; ∂<em
                  >t</em
                ><sub>i</sub>/∂<em>t</em><sub>0</sub> = 1, &nbsp; ∂<em>t</em
                ><sub>i</sub>/∂<em>v</em> = − <em>R</em><sub>i</sub> /
                <em>v</em>².
              </span>
            </div>
          </div>
          <!-- 
          <div class="card">
            <h2>Iteration loop &amp; stopping</h2>
            <p>Initialization (simple and reproducible):</p>
            <div class="eq">
              <span class="math">
                <em>m</em><sup>(0)</sup> = [ mean(<em>x</em><sub>i</sub>),
                &nbsp; mean(<em>y</em><sub>i</sub>), &nbsp; 0, &nbsp; <em>v</em
                ><sub>start</sub> ].
              </span>
            </div>
            <p>For <em>k</em> = 0, 1, …:</p>
            <ol>
              <li>
                Predict <em>g</em>(<em>m</em><sup>(k)</sup>) and residuals
                <em>r</em><sup>(k)</sup> = <em>d</em><sup>obs</sup> −
                <em>g</em>(<em>m</em><sup>(k)</sup>).
              </li>
              <li>
                Assemble <em>G</em>(<em>m</em><sup>(k)</sup>) and solve the
                normal equations for Δ<em>m</em><sup>(k)</sup>.
              </li>
              <li>
                Update &nbsp;<em>m</em><sup>(k+1)</sup> = <em>m</em
                ><sup>(k)</sup> + Δ<em>m</em><sup>(k)</sup>.
              </li>
              <li>
                Record convergence &nbsp;RMS<sup>(k)</sup> = √[ (1/<em>N</em>)
                ∑<sub>i</sub> (<em>r</em><sub>i</sub><sup>(k)</sup>)² ].
              </li>
            </ol>
            <p>
              Stop when ‖Δ<em>m</em><sup>(k)</sup>‖<sub>2</sub> &lt; ε (e.g.,
              10<sup>−4</sup>) or when the iteration count reaches
              <em>maxIter</em>. More iterations help when the start is far from
              the solution or the misfit valley is curved; early stopping occurs
              naturally when the update becomes negligible (already in the
              quadratic basin or noise-limited).
            </p>
          </div> -->
          <!-- 
          <div class="card">
            <h2>Notes</h2>
            <ul>
              <li>
                <span class="hi">Geometry matters:</span>
                well-spread stations reduce parameter coupling and improve
                stability of the normal equations.
              </li>
              <li>
                <span class="hi">Velocity bias:</span>
                if <em>v</em><sub>start</sub> differs from <em>v</em
                ><sup>true</sup>, the misfit basin and the estimate can shift
                even for small RMS.
              </li>
              <li class="muted">
                Assumptions: homogeneous velocity, depth fixed (<em>z</em>=0),
                identical pick variance (σ²), linearized updates via
                Gauss–Newton, and Tikhonov damping (λ) for stability.
              </li>
            </ul>
          </div> -->
        </section>
      </div>

      <footer class="main-footer">
        <h4 align="center">
          Lab contributed by IIT Roorkee
          <!-- Institute Name -->
        </h4>
      </footer>
    </div>
  </body>
</html>
<script>
  function theory() {
    document.getElementById("theory").style.backgroundColor = "#009dff";
  }
</script>
<!-- ./wrapper -->
<!-- jQuery 2.2.3 -->
<script src="../../plugins/jQuery/jquery-2.2.3.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<!-- Bootstrap 3.3.6 -->
<script src="../../bootstrap/js/bootstrap.min.js"></script>
<!-- Slimscroll -->
<script src="../../plugins/slimScroll/jquery.slimscroll.min.js"></script>
<!-- FastClick -->
<script src="../../plugins/fastclick/fastclick.js"></script>
<!-- AdminLTE App -->
<script src="../../dist/js/app.min.js"></script>
