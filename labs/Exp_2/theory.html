<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Virtual Labs</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
      name="viewport"
    />
    <!-- Bootstrap 3.3.6 -->
    <link rel="stylesheet" href="../../bootstrap/css/bootstrap.css" />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css"
    />
    <!-- Theme style -->
    <link rel="stylesheet" href="../../dist/css/AdminLTE.css" />
    <!-- AdminLTE Skins. Choose a skin from the css/skins folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="../../dist/css/skins/_all-skins.min.css" />
    <script>
      window.onload = function () {
        document.getElementById("theory").className = "active treeview";
      };
    </script>
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        margin: 24px;
        color: #1f2937;
        background: #fff;
      }
      p,
      li {
        text-align: justify;
      }
      h1,
      h2,
      h3 {
        margin: 10px 0 6px;
        color: #111827;
      }
      .card {
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 14px 16px;
        margin: 12px 0;
        background: #fafafa;
      }
      .eq {
        background: #f8fafc;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 8px 10px;
        overflow: auto;
        margin: 8px 0;
      }
      code {
        background: #eef2f7;
        padding: 2px 6px;
        border-radius: 6px;
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas,
          "Liberation Mono", monospace;
      }
      .muted {
        color: #6b7280;
      }
      .hi {
        color: #0ea5e9;
        font-weight: 600;
      } /* accent highlight */
      .warn {
        color: #a855f7;
        font-weight: 600;
      } /* uncertainty highlight */
      ul,
      ol {
        margin-left: 18px;
      }
    </style>
  </head>

  <body class="hold-transition skin-blue sidebar-mini">
    <!--Navigation Bar-->
    <div class="navbar navbar-default">
      <div class="container">
        <div class="navbar-header">
          <button
            type="button"
            class="navbar-toggle"
            data-toggle="collapse"
            data-target="#navbar-ex-collapse"
          >
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://iitb.ac.in"
            ><span
              ><img
                src="images/iitrLogo.png"
                style="margin-top: -15px; height: 50px; width: 400px" /></span
          ></a>
        </div>
        <div class="collapse navbar-collapse" id="navbar-ex-collapse"></div>
      </div>
    </div>

    <div class="wrapper">
      <header class="main-header">
        <!-- Logo -->
        <a
          href="../index.html"
          class="logo"
          style="
            background-color: #009dff;
            border-right: solid;
            border-right-color: #1261a0;
          "
        >
          <p align="center" style="font-size: 1em"><b>Geophysics Lab</b></p>
        </a>
        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top" style="background-color: #009dff">
          <!-- Sidebar toggle button-->
          <a
            href="#"
            class="sidebar-toggle"
            data-toggle="offcanvas"
            role="button"
            id="toggle_nav"
          >
            <span class="sr-only">Toggle navigation</span>
          </a>
          <section class="content-header">
            <ol class="breadcrumb">
              <li>
                <a href="../index.html"
                  ><i class="fa fa-dashboard"></i>Geophysics Lab</a
                >
              </li>
              <li>
                <a href="#">Finding location of an earthquake</a>
              </li>
            </ol>
          </section>
        </nav>
      </header>

      <!-- Left side column. contains the logo and sidebar -->
      <aside class="main-sidebar" style="background-color: #1261a0">
        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">
          <!-- search form -->
          <form action="#" method="get" class="sidebar-form">
            <div class="input-group"></div>
          </form>
          <!-- /.sear ch form -->
          <!-- sidebar menu: : style can be found in sidebar.less -->
          <ul class="sidebar-menu" style="background-color: #1261a0">
            <li class="treeview" id="aim">
              <a href="index.html" id="aim">
                <i class="fa fa-files-o" style="color: white"></i>
                <span style="color: white">Aim</span>
              </a>
            </li>
            <li class="treeview" id="theory">
              <a href="theory.html" id="theory" onclick="theory()">
                <i class="fa fa-files-o" style="color: white"></i>
                <span style="color: white">Theory</span>
              </a>
            </li>
            <!--   <li class="treeview" id="numerical">
                    <a href="numerical.php">
                        <i class="fa fa-laptop"></i>
                        <span>Numerical</span>
                        <span class="pull-right-container">
                        </span>
                    </a>
                </li>
                <li class="treeview" id="program">
                    <a href="program.php">
                        <i class="fa fa-laptop"></i>
                        <span>Program</span>
                        <span class="pull-right-container">
                        </span>
                    </a>
                </li> -->
            <li class="treeview" id="pretest">
              <a href="pretest.html" id="pretest">
                <i class="fa fa-files-o" style="color: white"></i>
                <span style="color: white">Pre Test</span>
              </a>
            </li>

            <li class="treeview" id="procedure">
              <a href="procedure.html" id="procedure">
                <i class="fa fa-files-o" style="color: white"></i>
                <span style="color: white">Procedure</span>
              </a>
            </li>
            <li class="treeview" id="simulation">
              <a href="simulation.html" id="simulation">
                <i class="fa fa-laptop" style="color: white"></i>
                <span style="color: white">Simulation</span>
                <span class="pull-right-container"> </span>
              </a>
            </li>

            <li class="treeview" id="posttest">
              <a href=" posttest.html" id="posttest">
                <i class="fa fa-files-o" style="color: white"> </i>
                <span style="color: white">Post Test</span>
                <span class="pull-right-container"> </span>
              </a>
            </li>
            <li class="treeview" id="ref">
              <a href="references.html" id="references">
                <i class="fa fa-files-o" style="color: white"></i>
                <span style="color: white">References</span>
                <span class="pull-right-container"> </span>
              </a>
            </li>
          </ul>
        </section>
        <!-- /.sidebar -->
      </aside>

      <div class="content-wrapper">
        <section class="content-header">
          <h1 align="center">Finding location of an earthquake</h1>
        </section>

        <!-- Main content -->
        <section class="content">
          <!-- 1) Workflow -->
           <!-- QUICK THEORY OVERVIEW -->
<!-- QUICK THEORY OVERVIEW (plain-language, no symbols/equations) -->
<div class="card" id="theory-brief">
  <h2> Overview</h2>

  <p><b>Arrival-Time </b> —
    Imagine a wave leaving the earthquake and traveling in a straight line at a constant speed.
    The time a station records is just “when the quake started” plus “how long the wave took to get there,”
    which depends on how far the station is and how fast the wave travels.
  </p>

  <p><b>Synthetic Arrival Times</b> —
    Real measurements are never perfect. To mimic that, we start from the ideal time,
    add a small random error (like human picking uncertainty), and sometimes add one big mistake on purpose
    to see how the method handles bad data.
  </p>

  <p><b>Inverse Modeling</b> —
    We guess the earthquake’s location, depth, start time, and wave speed.
    Then we compare predicted times with the measured ones, look at the differences,
    and adjust our guess to make those differences smaller.
    We also give less weight to noisier stations and take careful, stabilized steps so the solution stays sensible.
  </p>

  <p><b>Misfit Map</b> —
    This is a heatmap showing “how well” each map location explains the data (for a chosen depth and assumed speed).
    Each pixel tests one location: warmer colors mean a better match.
    The best area is where the predictions agree most with the observations.
  </p>
</div>


         
          <!-- 2) ARRIVAL-TIME CALCULATION (forward physics) -->
  <div class="card">
  <h2>Arrival-Times Calculation (Forward Model)</h2>

  <!-- 1) Brief theory & explanation -->
  <!-- <h3 style="margin:8px 0 6px;">Brief theory & explanation</h3> -->
  <p>
    In a constant-speed medium, the first P-wave travels in a straight line from the source to each station.
    The recorded time at a station equals the earthquake’s start time plus the travel time, which depends on
    how far the station is from the source and how fast the wave moves.
  </p>
  <p>
    These predicted times form the “forward model.” When they closely match the measured picks, our guessed
    source location, origin time, and speed are likely correct.
  </p>

  <!-- 2) Equations -->
  <div
              style="
                display: block;
                max-width: min(760px, 92vw);
                margin: 16px auto;
                text-align: center;
                line-height: 1.6;
                overflow-wrap: anywhere;
              "
            >
              <span class="eq" style="display: block">
                <span
                  class="math"
                  style="
                    display: inline-block;
                    font-size: clamp(1.22rem, 1rem + 1vw, 1.95rem);
                    font-weight: 400;
                    letter-spacing: 0.02px;
                  "
                >
                   <!-- Distance R_i -->
  <div style="display:block;max-width:min(760px,92vw);margin:8px auto;text-align:center;line-height:1.6;overflow-wrap:anywhere;">
    <img
      src="https://latex.codecogs.com/png.image?\dpi{110}R_i=\sqrt{(x_s-x_i)^2&plus;(y_s-y_i)^2&plus;(z_s-z_i)^2}"
      alt="R_i distance"
      style="max-width:100%;height:auto;"
    />
    <!-- <div style="font-size:.95rem;color:#555;margin-top:4px;">(Distance from source to station i)</div> -->
  </div>

  <!-- Forward model g_i(m) -->
  <div style="display:block;max-width:min(760px,92vw);margin:8px auto;text-align:center;line-height:1.6;overflow-wrap:anywhere;">
    <img
      src="https://latex.codecogs.com/png.image?\dpi{110}g_i(\mathbf{m})=t_0&plus;\frac{R_i}{v}"
      alt="forward model g_i"
      style="max-width:100%;height:auto;"
    />
    <!-- <div style="font-size:.95rem;color:#555;margin-top:4px;">(Predicted arrival time at station i)</div> -->
  </div>
                </span>
              </span>
            </div>



  <!-- 3) Symbols (what they mean) -->
  <!-- <h3 style="margin:14px 0 8px;">Symbols (what they mean)</h3> -->
  <ul style="margin:0;padding-left:18px;">
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}R_i" alt="R_i" /> — distance from source to station i (km).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}(x_s,y_s,z_s)" alt="xs ys zs" /> — source (earthquake) coordinates (km).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}(x_i,y_i,z_i)" alt="xi yi zi" /> — station i coordinates (km).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}t_0" alt="t0" /> — origin (start) time of the earthquake (s).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}v" alt="v" /> — P-wave speed (km·s^{-1}).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}g_i(\mathbf{m})" alt="g_i(m)" /> — predicted arrival time at station i (s).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\mathbf{m}=[x_s,y_s,z_s,t_0,v]" alt="m vector" /> — model parameters we estimate.</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}i=1,\dots,N" alt="i index" /> — station index (there are N stations).</li>
  </ul>

  <!-- <p style="margin-top:10px;font-size:.95rem;color:#555;">
    Units: coordinates in km, speed in km·s<sup>−1</sup>, times in seconds.
  </p> -->
</div>




          <!-- 3) SYNTHETIC TIMES WITH NOISE & OUTLIER -->
          <div class="card">
            <h2>Synthetic Arrival Times</h2>
            <!-- <h3 style="margin:8px 0 6px;">Brief theory & explanation</h3> -->
  <p>
    Real arrival-time picks contain randomness (human picking uncertainty, instrument noise, etc.).
    To mimic that, we start from the ideal, noise-free travel time and add small random errors.
    We can also inject one deliberately large mistake (an outlier) to see how robust the inversion is.
  </p>
  <p>
    These simulated “observed” times are what the inversion tries to fit. If our model is right and noise is small,
    the average mismatch will be close to the noise level.
  </p>
            <!-- t_obs -->
            <div
              style="
                display: block;
                max-width: min(760px, 92vw);
                margin: 12px auto;
                text-align: center;
                line-height: 1.6;
                overflow-wrap: anywhere;
              "
            >
              <span class="eq" style="display: block">
                <span
                  class="math"
                  style="
                    display: inline-block;
                    font-size: clamp(1.22rem, 1rem + 1vw, 1.95rem);
                    font-weight: 400;
                    letter-spacing: 0.02px;
                  "
                >
                  <img
                    src="https://latex.codecogs.com/png.image?\dpi{110}t_i^{\text{obs}}=t_0^{\text{true}}+\frac{R_i(\mathbf{m}^{\text{true}})}{v^{\text{true}}}+\varepsilon_i+\delta_i^{\text{outlier}}"
                    alt="t_obs"
                  />
                </span>
              </span>
            </div>
            <!-- <div>
              <p>
                <b>Symbols:</b> <img src="https://latex.codecogs.com/png.image?\dpi{110}\(t_i^{\text{obs}}\)" title="\(t_i^{\text{obs}}\)" /> observed pick (s);
                <img src="https://latex.codecogs.com/png.image?\dpi{110}\(t_0^{\text{true}}" title="\(t_0^{\text{true}}" />, <img src="https://latex.codecogs.com/png.image?\dpi{110}v^{\text{true}},\mathbf&space;m^{\text{true}}\)" title="v^{\text{true}},\mathbf m^{\text{true}}\)" />
                true values; <img src="https://latex.codecogs.com/png.image?\dpi{110}\(\varepsilon_i\)" title="\(\varepsilon_i\)" /> random error;
                <img src="https://latex.codecogs.com/png.image?\dpi{110}\(\delta_i^{\text{outlier}}\)" title="\(\delta_i^{\text{outlier}}\)" /> optional gross error.
              </p>
              <p>
                <b>Theory:</b> Observations equal noiseless prediction plus
                small random error, and sometimes a large mistake to test
                robustness.
              </p>
            </div> -->

            <!-- noise & outlier -->
            <div
              style="
                display: block;
                max-width: min(760px, 92vw);
                margin: 6px auto;
                text-align: center;
                line-height: 1.6;
                overflow-wrap: anywhere;
              "
            >
              <span class="eq" style="display: block">
                <span
                  class="math"
                  style="
                    display: inline-block;
                    font-size: clamp(1.16rem, 0.98rem + 0.9vw, 1.8rem);
                    font-weight: 400;
                    letter-spacing: 0.02px;
                  "
                >
                  <img
                    src="https://latex.codecogs.com/png.image?\dpi{110}\varepsilon_i\sim\mathcal{N}(0,\sigma^2),\qquad\delta_i^{\text{outlier}}\in\{0,\,\pm k\sigma\}"
                    alt="noise+outlier"
                  />
                </span>
              </span>
            </div>
        
          





  <!-- 3) Symbols (what they mean) -->

  <ul style="margin:0;padding-left:18px;">
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}t_i^{\mathrm{obs}}" alt="t_i^obs" /> — the simulated “observed” pick at station i (seconds).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}t_0^{\mathrm{true}}" alt="t0 true" /> — the true (hidden) origin time (seconds).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\mathbf{m}^{\mathrm{true}}" alt="m true" /> — the true (hidden) source parameters (location, depth, etc.).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}v^{\mathrm{true}}" alt="v true" /> — the true wave speed (km·s<sup>−1</sup>).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}R_i(\mathbf{m}^{\mathrm{true}})" alt="Ri of m true" /> — true source–station distance for station i (km).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\varepsilon_i" alt="epsilon_i" /> — random pick error (“noise”) with zero mean and spread set by σ (seconds).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\sigma" alt="sigma" /> — noise standard deviation; larger values mean more scattered picks (seconds).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\delta_i^{\mathrm{outlier}}" alt="delta outlier" /> — optional large error added to one pick (seconds).</li>
    <li><img src="https://latex.codecogs.com/png.image?\dpi{110}k" alt="k" /> — outlier size in “sigma units” (e.g., 3 means three times the noise spread).</li>
  </ul>


          </div>

          <!-- 4) INVERSE MODELING: RMS, JACOBIAN, WHITENING, TIKHONOV -->
        <div class="card">
  <h2>Inverse Modeling</h2>

  <p>
    We estimate the model <img src="https://latex.codecogs.com/png.image?\dpi{110}\mathbf{m}" alt="m" />
    by minimizing squared residuals. Because
    <img src="https://latex.codecogs.com/png.image?\dpi{110}g(\mathbf{m})" alt="g(m)" />
    is nonlinear, we linearize around the current guess
    <img src="https://latex.codecogs.com/png.image?\dpi{110}\mathbf{m}^{(k)}" alt="m^(k)" />,
    solve a damped system for
    <img src="https://latex.codecogs.com/png.image?\dpi{110}\Delta\mathbf{m}" alt="Delta m" />,
    and iterate.
  </p>

  <!-- Residuals & RMS -->
  <p><b>Residuals and RMS</b><p style="margin:4px 0 8px;"> Residual = measured minus predicted; RMS = typical size of those residuals. Smaller is better.</p></p>
  <div style="display:block;max-width:min(760px,92vw);margin:12px auto;text-align:center;line-height:1.6;overflow-wrap:anywhere;">
    <span class="eq" style="display:block">
      <span class="math" style="display:inline-block;font-size:clamp(1.22rem,1rem + 1vw,1.95rem);font-weight:400;letter-spacing:0.02px;">
        <img
          src="https://latex.codecogs.com/png.image?\dpi{110}r_i(\mathbf{m})=t_i^{\mathrm{obs}}-g_i(\mathbf{m}),\qquad\mathrm{RMS}(\mathbf{m})=\sqrt{\frac{1}{N}\sum_{i=1}^{N}r_i^2}"
          alt="residual and RMS"
        />
      </span>
    </span>
  </div>
  <div>
    <!-- <p><b>Symbols (for this equation):</b></p> -->
    <ul style="margin:0;padding-left:18px;">
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}r_i(\mathbf{m})" alt="ri" /> — residual at station i (observed − predicted) [s].</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}t_i^{\mathrm{obs}}" alt="tiobs" /> — observed pick time at station i [s].</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}g_i(\mathbf{m})" alt="g_i" /> — predicted arrival time at station i [s].</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\mathrm{RMS}(\mathbf{m})" alt="RMS" /> — root-mean-square misfit over all stations [s].</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}N" alt="N" /> — number of stations.</li>
    </ul>
  </div>

  <!-- Jacobian / Linearization -->
  <p style="margin-top:14px;"><b>Linearization (Jacobian)</b>  <p style="margin:4px 0 8px;"> Approximate the nonlinear model by a straight line near the current guess.</p>
    <!-- <img src="https://latex.codecogs.com/png.image?\dpi{110}\mathbf{m}^{(k)}" alt="m^(k)" /> -->
  </p>
  <div style="display:block;max-width:min(760px,92vw);margin:12px auto;text-align:center;line-height:1.6;overflow-wrap:anywhere;">
    <span class="eq" style="display:block">
      <span class="math" style="display:inline-block;font-size:clamp(1.18rem,0.98rem + 0.9vw,1.85rem);font-weight:400;letter-spacing:0.02px;">
        <img
          src="https://latex.codecogs.com/png.image?\dpi{110}\frac{\partial t_i}{\partial x_s}=\frac{x_s-x_i}{vR_i},\quad\frac{\partial t_i}{\partial y_s}=\frac{y_s-y_i}{vR_i},\quad\frac{\partial t_i}{\partial z_s}=\frac{z_s-z_i}{vR_i},\quad\frac{\partial t_i}{\partial t_0}=1,\quad\frac{\partial t_i}{\partial v}=-\frac{R_i}{v^2}"
          alt="Jacobian"
        />
      </span>
    </span>
  </div>
  <div>
    <!-- <p><b>Symbols (for this equation):</b></p> -->
    <ul style="margin:0;padding-left:18px;">
      <li>Each fraction is a partial derivative showing how the predicted time at station i changes if we nudge one parameter.</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}R_i" alt="Ri" /> — source–station distance [km]; closer stations (smaller <img src="https://latex.codecogs.com/png.image?\dpi{110}R_i" alt="Ri" />) are more sensitive.</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}G" alt="G" /> — the Jacobian matrix collecting these derivatives for all stations.</li>
    </ul>
  </div>

  <!-- Whitening -->
  <p style="margin-top:14px;"><b>Whitening (by noise)</b><p style="margin:4px 0 8px;"> Scale data by their uncertainty so precise stations count more and noisy ones count less—like measuring everything in its own “noise units”.</p></p>
  <div style="display:block;max-width:min(760px,92vw);margin:12px auto;text-align:center;line-height:1.6;overflow-wrap:anywhere;">
    <span class="eq" style="display:block">
      <span class="math" style="display:inline-block;font-size:clamp(1.18rem,0.98rem + 0.9vw,1.85rem);font-weight:400;letter-spacing:0.02px;">
        <img
          src="https://latex.codecogs.com/png.image?\dpi{110}W=\Sigma^{-1/2},\qquad G_w=WG,\qquad\mathbf{d}_w=W\mathbf{r}"
          alt="whitening"
        />
      </span>
    </span>
  </div>
  <div>
    <!-- <p><b>Symbols (for this equation):</b></p> -->
    <ul style="margin:0;padding-left:18px;">
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\Sigma=\mathrm{diag}(\sigma_1^2,\dots,\sigma_N^2)" alt="Sigma" /> — noise covariance (diagonal) from per-station spreads.</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}W=\Sigma^{-1/2}" alt="W" /> — whitening matrix (divide by noise stds).</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}G_w" alt="Gw" /> — whitened Jacobian; <img src="https://latex.codecogs.com/png.image?\dpi{110}\mathbf{d}_w" alt="dw" /> — whitened residuals.</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\sigma_i" alt="sigma_i" /> — standard deviation of pick noise at station i [s].</li>
    </ul>
  </div>

  <!-- Tikhonov-damped normal equations -->
  <p style="margin-top:14px;"><b>Tikhonov-damped normal equations</b><p style="margin:4px 0 8px;"> Solve for a safe update that balances fitting data and keeping steps stable; the damping value λ controls the safety vs. bias trade-off.</p></p>
  <div style="display:block;max-width:min(760px,92vw);margin:12px auto;text-align:center;line-height:1.6;overflow-wrap:anywhere;">
    <span class="eq" style="display:block">
      <span class="math" style="display:inline-block;font-size:clamp(1.22rem,1rem + 1vw,1.95rem);font-weight:400;letter-spacing:0.02px;">
        <img
          src="https://latex.codecogs.com/png.image?\dpi{110}(G_w^{\top}G_w+\lambda^2 I)\,\Delta\mathbf{m}=G_w^{\top}\mathbf{d}_w,\qquad\mathbf{m}^{(k+1)}=\mathbf{m}^{(k)}+\Delta\mathbf{m}"
          alt="Tikhonov normal equations"
        />
      </span>
    </span>
  </div>
  <div>
    <!-- <p><b>Symbols (for this equation):</b></p> -->
    <ul style="margin:0;padding-left:18px;">
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\Delta\mathbf{m}" alt="Delta m" /> — model update; moves the estimate.</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\lambda" alt="lambda" /> — damping (regularization) strength; larger values stabilize but add bias.</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}I" alt="I" /> — identity matrix.</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\mathbf{m}^{(k)}" alt="m^k" /> and <img src="https://latex.codecogs.com/png.image?\dpi{110}\mathbf{m}^{(k+1)}" alt="m^(k+1)" /> — model before/after the step.</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}G_w^{\top}" alt="GwT" /> — transpose of the whitened Jacobian.</li>
    </ul>
  </div>

  <ul style="margin-top:12px;">
    <li><b>Choosing <img src="https://latex.codecogs.com/png.image?\dpi{110}\lambda" alt="lambda" />:</b> increase if updates oscillate/blow up; decrease if progress is too slow.</li>
    <li><b>Stopping:</b> stop when <img src="https://latex.codecogs.com/png.image?\dpi{110}\|\Delta\mathbf{m}\|" alt="norm Delta m" /> is tiny or RMS stops improving.</li>
  </ul>
</div>


          <!-- 5) MISFIT MAP (2D scan) -->
          <div class="card">
  <h2>Misfit Map</h2>
  <p>
    We visualize how well different surface locations (x, y) at a chosen depth z fit the data using a fixed assumed speed.
    At each grid point we first pick the best origin time, then compute the average squared mismatch to plot as a heatmap.
  </p>

  <!-- 1) t0* -->
  <p><b>Best origin time at each grid point</b></p>
  <p style="margin:4px 0 8px;"> For each map location, choose the origin time that best matches the picks by averaging “observed minus travel-time”.</p>

  <div
    style="display:block;max-width:min(760px,92vw);margin:12px auto;text-align:center;line-height:1.6;overflow-wrap:anywhere;"
  >
    <span class="eq" style="display:block">
      <span
        class="math"
        style="display:inline-block;font-size:clamp(1.22rem,1rem + 1vw,1.95rem);font-weight:400;letter-spacing:0.02px;"
      >
        <img
          src="https://latex.codecogs.com/png.image?\dpi{110}t_0^*(x,y;z)=\frac{1}{N}\sum_{i=1}^{N}\!\left(t_i^{\mathrm{obs}}-\frac{R_i(x,y,z)}{v_{\mathrm{start}}}\right)"
          alt="t0 star"
        />
      </span>
    </span>
  </div>

  <div>
    <!-- <p><b>Symbols (for this equation):</b></p> -->
    <ul style="margin:0;padding-left:18px;">
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}t_0^*" alt="t0*" /> — best origin time chosen at that grid point (seconds).</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}t_i^{\mathrm{obs}}" alt="t_i^obs" /> — observed pick at station i (seconds).</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}R_i(x,y,z)" alt="Ri(x,y,z)" /> — trial distance from grid point to station i (km).</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}v_{\mathrm{start}}" alt="v_start" /> — assumed wave speed used for the scan (km·s<sup>−1</sup>).</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}N" alt="N" /> — number of stations.</li>
    </ul>
  </div>

  <!-- 2) J(x,y;z) -->
  <p style="margin-top:14px;"><b>Mean-squared misfit used for the map</b></p>
  <p style="margin:4px 0 8px;">With that best origin time, compute the average squared difference between observed and predicted times; lower values mean a better-fitting location.</p>

  <div
    style="display:block;max-width:min(760px,92vw);margin:6px auto;text-align:center;line-height:1.6;overflow-wrap:anywhere;"
  >
    <span class="eq" style="display:block">
      <span
        class="math"
        style="display:inline-block;font-size:clamp(1.22rem,1rem + 1vw,1.95rem);font-weight:400;letter-spacing:0.02px;"
      >
        <img
          src="https://latex.codecogs.com/png.image?\dpi{110}J(x,y;z)=\frac{1}{N}\sum_{i=1}^{N}\left[t_i^{\mathrm{obs}}-\left(t_0^*(x,y;z)+\frac{R_i(x,y,z)}{v_{\mathrm{start}}}\right)\right]^2=\mathrm{Var}_i\!\left(t_i^{\mathrm{obs}}-\frac{R_i(x,y,z)}{v_{\mathrm{start}}}\right)"
          alt="J(x,y;z)"
        />
      </span>
    </span>
  </div>

  <div>
    <!-- <p><b>Symbols (for this equation):</b></p> -->
    <ul style="margin:0;padding-left:18px;">
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}J(x,y;z)" alt="J" /> — mean-squared misfit at the grid point (seconds<sup>2</sup>).</li>
      <li><img src="https://latex.codecogs.com/png.image?\dpi{110}\mathrm{Var}_i(\cdot)" alt="Var_i" /> — sample variance taken over stations i.</li>
      <li>Other symbols are the same as above: <img src="https://latex.codecogs.com/png.image?\dpi{110}t_0^*" alt="t0*" />, <img src="https://latex.codecogs.com/png.image?\dpi{110}t_i^{\mathrm{obs}}" alt="t_i^obs" />, <img src="https://latex.codecogs.com/png.image?\dpi{110}R_i" alt="Ri" />, <img src="https://latex.codecogs.com/png.image?\dpi{110}v_{\mathrm{start}}" alt="v_start" />.</li>
    </ul>
  </div>

  <ul style="margin-top:12px;">
    <li><b>What it shows:</b> Low <em>J</em> marks candidate epicenters for the chosen depth and assumed speed. In the map, warmer colors mean lower misfit (better).</li>
    <li><b>Noise floor:</b> If the assumed speed and depth are correct and the data noise has standard deviation σ, the minimum of <em>J</em> should be near σ².</li>
    <li><b>Bias:</b> If the assumed speed differs from the true speed or the depth is wrong, the low-misfit basin shifts away from the true epicenter.</li>
    <li><b>Resolution controls:</b> Grid resolution (number of pixels), display depth z, and the assumed speed.</li>
  </ul>
</div>


          
        </section>
      </div>

      <footer class="main-footer">
        <h4 align="center">
          Lab contributed by IIT Roorkee
          <!-- Institute Name -->
        </h4>
      </footer>
    </div>
  </body>
</html>
<script>
  function theory() {
    document.getElementById("theory").style.backgroundColor = "#009dff";
  }
</script>
<!-- ./wrapper -->
<!-- jQuery 2.2.3 -->
<script src="../../plugins/jQuery/jquery-2.2.3.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<!-- Bootstrap 3.3.6 -->
<script src="../../bootstrap/js/bootstrap.min.js"></script>
<!-- Slimscroll -->
<script src="../../plugins/slimScroll/jquery.slimscroll.min.js"></script>
<!-- FastClick -->
<script src="../../plugins/fastclick/fastclick.js"></script>
<!-- AdminLTE App -->
<script src="../../dist/js/app.min.js"></script>
